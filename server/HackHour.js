const data = {
  companies: [
    {
      company_id: 3,
      name: "square",
      description: "digital payment",
      employees: [
        {
          user_id: 19,
          name: "Sett's Sister",
          company_id: 3,
        },
        {
          user_id: 20,
          name: "Eazy",
          company_id: 3,
        },
        {
          user_id: 21,
          name: "Eazy",
          company_id: 3,
        },
        {
          user_id: 22,
          name: "Eazy",
          company_id: 3,
        },
      ],
    },
    {
      company_id: 4,
      name: "Amazon",
      description: "creator of audible",
      employees: [
        {
          user_id: 14,
          name: "Kellen",
          company_id: 4,
        },
      ],
    },
    {
      company_id: 6,
      name: "Disney",
      description: "movies",
      employees: [],
    },
    {
      company_id: 8,
      name: "Tesla",
      description: "EV",
      employees: [],
    },
    {
      company_id: 10,
      name: "Starbucks",
      description: "coffee",
      employees: null,
    },
    {
      company_id: 11,
      name: "Twitter",
      description: "social network",
      employees: [],
    },
    {
      company_id: 12,
      name: null,
      description: null,
      employees: null,
    },
    {
      company_id: 13,
      name: "GME",
      description: "games",
      employees: null,
    },
    {
      company_id: 14,
      name: "GMX",
      description: "games",
      employees: null,
    },
    {
      company_id: 15,
      name: "GMX",
      description: "games",
      employees: null,
    },
    {
      company_id: 2,
      name: "Amazon?",
      description: "Brazil",
      employees: [
        {
          user_id: 3,
          name: "Sett",
          company_id: 2,
        },
        {
          user_id: 4,
          name: "ErikR",
          company_id: 2,
        },
        {
          user_id: 2,
          name: "Coral Updated",
          company_id: 2,
        },
        {
          user_id: 18,
          name: "Sett's Brother",
          company_id: 2,
        },
        {
          user_id: 23,
          name: "Eazy",
          company_id: 2,
        },
        {
          user_id: 24,
          name: "Testing",
          company_id: 2,
        },
        {
          user_id: 25,
          name: "Testing1",
          company_id: 2,
        },
        {
          user_id: 26,
          name: "Testing1",
          company_id: 2,
        },
        {
          user_id: 27,
          name: "AJ",
          company_id: 2,
        },
        {
          user_id: 28,
          name: "EasyE",
          company_id: 2,
        },
        {
          user_id: 30,
          name: "Easy1",
          company_id: 2,
        },
        {
          user_id: 31,
          name: "Coral2",
          company_id: 2,
        },
        {
          user_id: 32,
          name: "Easyf",
          company_id: 2,
        },
        {
          user_id: 1,
          name: "Erik M.",
          company_id: 2,
        },
      ],
    },
    {
      company_id: 1,
      name: "Tesla",
      description: "eV",
      employees: [],
    },
    {
      company_id: 16,
      name: "Instabloomer",
      description: "Grow Instagram followings",
      employees: [],
    },
    {
      company_id: 17,
      name: "Cool Comfort1",
      description: "cooling",
      employees: [],
    },
    {
      company_id: 18,
      name: "Cool Comfort2",
      description: "cooling",
      employees: null,
    },
    {
      company_id: 19,
      name: "CoolComfort 7",
      description: "things",
      employees: null,
    },
    {
      company_id: 20,
      name: "CoolComfort 8",
      description: "things",
      employees: null,
    },
    {
      company_id: 21,
      name: "Cool Comfort9",
      description: "cooling",
      employees: null,
    },
    {
      company_id: 22,
      name: "Cool Comfort11",
      description: "cooling",
      employees: null,
    },
    {
      company_id: 23,
      name: "Dell",
      description: "computers",
      employees: [],
    },
  ],
};

const data1 = {
  users: [
    {
      user_id: 3,
      name: "Sett",
      company_id: 2,
    },
    {
      user_id: 4,
      name: "ErikR",
      company_id: 2,
    },
    {
      user_id: 14,
      name: "Kellen",
      company_id: 4,
    },
    {
      user_id: 2,
      name: "Coral Updated",
      company_id: 2,
    },
    {
      user_id: 18,
      name: "Sett's Brother",
      company_id: 2,
    },
    {
      user_id: 19,
      name: "Sett's Sister",
      company_id: 3,
    },
    {
      user_id: 20,
      name: "Eazy",
      company_id: 3,
    },
    {
      user_id: 21,
      name: "Eazy",
      company_id: 3,
    },
    {
      user_id: 22,
      name: "Eazy",
      company_id: 3,
    },
    {
      user_id: 23,
      name: "Eazy",
      company_id: 2,
    },
    {
      user_id: 25,
      name: "Testing1",
      company_id: 2,
    },
    {
      user_id: 26,
      name: "Testing1",
      company_id: 2,
    },
    {
      user_id: 27,
      name: "AJ",
      company_id: 2,
    },
    {
      user_id: 28,
      name: "EasyE",
      company_id: 2,
    },
    {
      user_id: 30,
      name: "Easy1",
      company_id: 2,
    },
    {
      user_id: 31,
      name: "Coral2",
      company_id: 2,
    },
    {
      user_id: 32,
      name: "Easyf",
      company_id: 2,
    },
    {
      user_id: 1,
      name: "Erik M.",
      company_id: 2,
    },
    {
      user_id: 33,
      name: "Easyk",
      company_id: 2,
    },
    {
      user_id: 34,
      name: "Easyl",
      company_id: 2,
    },
    {
      user_id: 35,
      name: "Easym",
      company_id: 2,
    },
    {
      user_id: 36,
      name: "Easyn",
      company_id: 2,
    },
    {
      user_id: 37,
      name: "Easyo",
      company_id: 2,
    },
    {
      user_id: 38,
      name: "Easyp",
      company_id: 2,
    },
    {
      user_id: 39,
      name: "Easyq",
      company_id: 2,
    },
    {
      user_id: 40,
      name: "Easyr",
      company_id: 2,
    },
    {
      user_id: 41,
      name: "Easys",
      company_id: 2,
    },
    {
      user_id: 42,
      name: "Easyt",
      company_id: 2,
    },
    {
      user_id: 43,
      name: "john",
      company_id: 4,
    },
    {
      user_id: 44,
      name: "johe",
      company_id: 4,
    },
    {
      user_id: 45,
      name: "johe",
      company_id: 4,
    },
    {
      user_id: 46,
      name: "Test2",
      company_id: 4,
    },
    {
      user_id: 24,
      name: "Scarlet",
      company_id: 2,
    },
  ],
};

const spaceX = {
  launchesPast: [
    {
      mission_name: "Starlink-15 (v1.0)",
      launch_date_local: "2020-10-24T11:31:00-04:00",
      launch_site: {
        site_name_long:
          "Cape Canaveral Air Force Station Space Launch Complex 40",
      },
      links: {
        article_link: null,
        video_link: "https://youtu.be/J442-ti-Dhg",
      },
    },
    {
      mission_name: "Sentinel-6 Michael Freilich",
      launch_date_local: "2020-11-21T09:17:00-08:00",
      launch_site: {
        site_name_long: "Vandenberg Air Force Base Space Launch Complex 4E",
      },
      links: {
        article_link:
          "https://spaceflightnow.com/2020/11/21/international-satellite-launches-to-extend-measurements-of-sea-level-rise/",
        video_link: "https://youtu.be/aVFPzTDCihQ",
      },
    },
    {
      mission_name: "Crew-1",
      launch_date_local: "2020-11-15T19:27:00-05:00",
      launch_site: {
        site_name_long: "Kennedy Space Center Historic Launch Complex 39A",
      },
      links: {
        article_link:
          "https://spaceflightnow.com/2020/11/16/astronauts-ride-spacex-crew-capsule-in-landmark-launch-for-commercial-spaceflight/",
        video_link: "https://youtu.be/bnChQbxLkkI",
      },
    },
    {
      mission_name: "GPS III SV04 (Sacagawea)",
      launch_date_local: "2020-11-05T18:24:00-05:00",
      launch_site: {
        site_name_long:
          "Cape Canaveral Air Force Station Space Launch Complex 40",
      },
      links: {
        article_link:
          "https://spaceflightnow.com/2020/11/06/spacex-launches-gps-navigation-satellite-from-cape-canaveral/",
        video_link: "https://youtu.be/wufXF5YKR1M",
      },
    },
    {
      mission_name: "Starlink-14 (v1.0)",
      launch_date_local: "2020-10-24T11:31:00-04:00",
      launch_site: {
        site_name_long:
          "Cape Canaveral Air Force Station Space Launch Complex 40",
      },
      links: {
        article_link:
          "https://spaceflightnow.com/2020/10/24/spacex-adds-another-60-satellites-to-starlink-network/",
        video_link: "https://youtu.be/2gbVgTxLgN0",
      },
    },
    {
      mission_name: "Starlink-13 (v1.0)",
      launch_date_local: "2020-10-18T08:25:00-04:00",
      launch_site: {
        site_name_long: "Kennedy Space Center Historic Launch Complex 39A",
      },
      links: {
        article_link:
          "https://spaceflightnow.com/2020/10/18/spacex-launches-another-batch-of-starlink-satellites/",
        video_link: "https://youtu.be/UM8CDDAmp98",
      },
    },
    {
      mission_name: "Starlink-12 (v1.0)",
      launch_date_local: "2020-10-06T07:29:00-04:00",
      launch_site: {
        site_name_long: "Kennedy Space Center Historic Launch Complex 39A",
      },
      links: {
        article_link: null,
        video_link: "https://youtu.be/8O8Z2yPyTnc",
      },
    },
    {
      mission_name: "Starlink-11 (v1.0)",
      launch_date_local: "2020-09-03T08:46:00-04:00",
      launch_site: {
        site_name_long: "Kennedy Space Center Historic Launch Complex 39A",
      },
      links: {
        article_link: null,
        video_link: "https://youtu.be/_j4xR7LMCGY",
      },
    },
    {
      mission_name: "SAOCOM 1B, GNOMES-1, Tyvak-0172",
      launch_date_local: "2020-08-30T19:18:00-04:00",
      launch_site: {
        site_name_long:
          "Cape Canaveral Air Force Station Space Launch Complex 40",
      },
      links: {
        article_link:
          "https://spaceflightnow.com/2020/08/31/spacex-launches-first-polar-orbit-mission-from-florida-in-decades/",
        video_link: "https://youtu.be/P-gLOsDjE3E",
      },
    },
    {
      mission_name: "Starlink-10 (v1.0) & SkySat 19-21",
      launch_date_local: "2020-08-18T10:31:00-04:00",
      launch_site: {
        site_name_long:
          "Cape Canaveral Air Force Station Space Launch Complex 40",
      },
      links: {
        article_link:
          "https://spaceflightnow.com/2020/08/18/spacex-adds-more-satellites-to-ever-growing-starlink-network/",
        video_link: "https://youtu.be/jTMJK7wb0rM",
      },
    },
  ],
};

const SpaceX1 = {
  launchesPast: [
    {
      mission_name: "Starlink-15 (v1.0)",
      launch_date_local: "2020-10-24T11:31:00-04:00",
      launch_site: {
        site_name_long:
          "Cape Canaveral Air Force Station Space Launch Complex 40",
      },
      links: {
        article_link: null,
        video_link: "https://youtu.be/J442-ti-Dhg",
      },
    },
  ],
};

const filterArray = (arr, query) => {
  const result = [];
  arr.forEach((e) => {
    result.push(filterObj(e, query));
  });
  return result;
};

const filterObj = (obj, query) => {
  const result = {};
  const arr = [];
  let nestedQuery;
  query.forEach((e) => {
    if (typeof e !== "object") {
      arr.push(e);
    } else {
      nestedQuery = e;
    }
  });

  // const arr = query;
  Object.keys(obj).forEach((e) => {
    if (arr.includes(e)) {
      result[e] = obj[e];
    }
  });
  if (nestedQuery) {
    Object.keys(nestedQuery).forEach((e) => {
      result[e] = filterData(obj, nestedQuery);
    });
  }
  return result;
};

const filterData = (cachedData, query) => {
  //final result
  const result = {};

  Object.keys(cachedData).forEach((e) => {
    if (Array.isArray(cachedData[e])) {
      result[e] = filterArray(cachedData[e], query[e]);
    } else if (typeof cachedData[e] === "object") {
      result[e] = cachedData[e];
    }
  });
  return result;
};

const nested_data = {
  companies: ["company_id", "name", {"employees": ["user_id", {"project": ["project_name", "project_id"]}]}],
};
["company_d"]["employee"]
console.log(filterData(data, nested_data));

//{ employees: ["name", "user_id"] }
//{"employees": ["name", "user_id"]}
// const nested_data1 = {
//  users: [ "user_id", "name" ]
// }
// const spaceX_query = {
//   launchesPast: [
//     "mission_name",
//     "launch_date_local",
//     // {launch_site :["site_name_long"]},
//     { links: ["article_link", "video_link"] },
//   ],
// };
